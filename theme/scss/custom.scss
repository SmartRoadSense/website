// Ripped out from Bootstrap variables

$white:    #fff !default;
$gray-100: #f8f9fa !default;
$gray-200: #e9ecef !default;
$gray-300: #dee2e6 !default;
$gray-400: #ced4da !default;
$gray-500: #adb5bd !default;
$gray-600: #6c757d !default;
$gray-700: #495057 !default;
$gray-800: #343a40 !default;
$gray-900: #212529 !default;
$black:    #000 !default;

$shadow:   rgba(8, 20, 43, 0.5);

$gray-primary: #dce0ea;

// Bootstrap overrides
//
// Copy variables from `_variables.scss` to this file to override default values
// without modifying source files.

$primary:                   #2a69ff;
$info:                      #bcd0ff;

$enable-rounded:            false;
$enable-shadows:            true;
$enable-gradients:          true;
$enable-transitions:        true;

$font-size-base:            1.05rem;
$body-color:                $gray-900;
$link-decoration:           underline;

$navbar-dark-color:             $gray-300;
$navbar-dark-hover-color:       $white;
$navbar-dark-active-color:      $white;
$navbar-dark-disabled-color:    $gray-500;
$navbar-dark-toggler-border-color: rgba($white, .5);

$dropdown-link-color:           $body-color;
$dropdown-link-hover-color:     $primary;
$dropdown-link-hover-bg:        transparent;
$dropdown-link-active-color:    $primary;
$dropdown-link-active-bg:       transparent;
$dropdown-bg:                   rgba(255, 255, 255, 0.9);
$dropdown-box-shadow:           $shadow 6px 6px 12px;

// General font stuff
$font-family-base:              'Open Sans', "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";

$font-size-h1:                  $font-size-base * 3;
$font-size-h2:                  $font-size-base * 2.5;
$font-size-h3:                  $font-size-base * 2;

$font-weight-normal: 400;
$font-weight-bold: 600;
$lead-font-weight: 400;

// Code
$code-font-size:                    100%;
$code-color:                        $gray-700;
$code-background:                   $gray-100;
$pre-color:                         $gray-700;
$pre-scrollable-max-height:         340px;

code {
    border: solid 1px $gray-500;
    border-radius: 2px;
    padding: 2px;
}
code, pre {
    background-color: $code-background;
}

@import "../node_modules/bootstrap/scss/bootstrap";

// Additional CSS
a {
    text-decoration-skip: ink;
}

.no-trans {
    transition: unset !important;
}

img.icon {
    width: auto;
    height: 1em;
}

// Sticky footer
html, body {
    height: 100%;
}
body {
    display: flex;
    flex-direction: column;

    > .content {
        flex: 1 0 auto;
    }
}
footer {
    flex-shrink: 0;
}

// Transition offsets
.trans-offset-1 {
    transition-delay: 0ms !important;
}
.trans-offset-2 {
    transition-delay: 500ms !important;
}
.trans-offset-3 {
    transition-delay: 1000ms !important;
}
.trans-offset-4 {
    transition-delay: 1500ms !important;
}

// Navbar
nav.navbar {
    transition: background-color .35s linear, background-position .35s ease-out;

    background: linear-gradient(to bottom, rgba($black, 0.22), rgba($black, 0.0) 90%);
    background-color: transparent;
    background-repeat: no-repeat;
    background-position: 0 0;

    a.navbar-brand {
        color: $gray-300;
        text-shadow: $shadow 1px 1px 3px;
        text-decoration: none;
    }
    a.navbar-brand:hover {
        color: $white;
    }

    a.nav-link {
        text-shadow: $shadow 1px 1px 1px;
        text-decoration: none;
    }

    &.scrolled {
        background-color: $primary;
        background-position: 0 -60px;
    }
    &.expanded {
        @include media-breakpoint-down(sm) {
            background: $primary;
        }
    }
}

.dropdown-item {
    text-decoration: none;
}

// Jumbotron
$jumbotron-bg: transparent;

// Header
header {
    position: relative;
    height: 250px;
    margin-bottom: 2em;

    background-color: $primary;
    color: $white;

    .background {
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;

        background-color: $primary;

        > img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center center;
        }
    }

    .occluder {
        position: absolute;
        bottom: 0;
        width: 100%;
        height: 70px;
        background: linear-gradient(to bottom right, transparent 0, transparent 50%, $white 50%, $white 100%);
    }

    .bottom-aligner {
        position: absolute;
        bottom: 2em;
        width: 100%;
    }

    h1 {
        font-weight: 600;
        white-space: nowrap;

        margin-left: -0.35em;
        margin-bottom: -0.1em;

        font-size: 3rem;
        @include media-breakpoint-only(sm) {
            font-size: 3.2rem;
        }
        @include media-breakpoint-only(md) {
            font-size: 3.6rem;
        }
        @include media-breakpoint-up(lg) {
            font-size: 4rem;
        }

        transform: rotateZ(3deg);
        transform-origin: left center;

        span {
            color: $white;
            background: $primary url(../images/stripe_blue.png) repeat;
            padding: .1em .5em;
            box-decoration-break: clone;
        }
    }

    .lead {
        @include media-breakpoint-up(md) {
            font-size: ($font-size-base * 1.5);
        }
    }
}
header.hero {
    height: 400px;
    @include media-breakpoint-up(md) {
        height: 600px;
    }
    margin-bottom: 1em;

    background-color: $primary;

    > .occluder {
        position: absolute;
        bottom: 0;
        width: 100%;
        height: 200px;
        background: linear-gradient(to bottom right, transparent 0, transparent 50%, $white 50%, $white 100%);
    }

    .logo {
        img {
            @include media-breakpoint-up(md) {
                position: relative;
                top: 20px;
            }

            width: 100%;
            height: auto;
        }
    }

    h1 {
        white-space: unset;
        text-shadow: $black 1px 1px 3px;

        margin-left: 0;
        margin-bottom: 0.15em;

        transform: unset;

        span {
            padding: 0;
            background: none;
        }
    }

    p {
        display: inline;
        position: relative;

        white-space: pre-wrap;
        line-height: 1.7;
        border: 0 solid $primary;
        border-width: 0.3em 0;

        &, &:after {
            background: $primary;
        }
        &:after {
            content: "";
            position: absolute;
            top: -0.3em;
            right: 100%;
            bottom: -0.3em;
            width: 0.5em;
        }

        > span {
            position: relative;
            z-index: 1;
            padding-right: 0.5em;
            box-decoration-break: clone;
        }
    }
}

.main {
    p {
        line-height: 1.7;
    }
    ul, ol {
        line-height: 2;
    }
}

section {
    &:last-of-type {
        padding-bottom: ($font-size-base * 3);
    }

    &:nth-of-type(2n) {
        background: $gray-primary;

        > .occluder {
            width: 100%;
            height: 70px;
            background: linear-gradient(to bottom right, $body-bg 0, $body-bg 50%, $gray-primary 50%, $gray-primary 100%);
        }
    }
    &:nth-of-type(2n+1) {

        > .occluder {
            width: 100%;
            height: 70px;
            background: linear-gradient(to bottom right, $gray-primary 0, $gray-primary 50%, $body-bg 50%, $body-bg 100%);
        }
    }
}

.section-title {
    margin-top: -30px;
    margin-bottom: .5em;
    @include media-breakpoint-up(sm) {
        margin-left: -0.35em;
    }

    white-space: nowrap;
    font-size: $h2-font-size;
    @include media-breakpoint-up(md) {
        font-size: ($h2-font-size * 1.25);
    }

    transform: rotateZ(-3deg);
    transform-origin: left center;

    &.scroll-in {
        transform: rotateZ(-10deg);
        opacity: 0;
    }

    opacity: 1;
    transition: transform 1.5s ease-out, opacity 0.6s linear;

    span {
        color: $white;
        background: $primary url(../images/stripe_blue.png) repeat;
        padding: 0.15em 0.35em;
    }
}

.gallery {
    overflow: hidden;

    margin-bottom: 0;
    &:last-child {
        margin-bottom: -($font-size-base); /* compensates margins of inner items */
    }

    .item {
        margin-bottom: $font-size-base;
    }

    img {
        width: 100%;
        height: auto;
    }
}
.picture {
    margin-bottom: $font-size-base;
    &:last-child {
        margin-bottom: 0;
    }

    img {
        width: 100%;
        height: auto;
    }
}
.gallery, .picture {
    .didascaly {
        font-size: $small-font-size;
        font-style: italic;
        text-align: center;
    }
}

.video-player, .slideshare {
    width: 100%;
    max-width: 800px;
    margin: 0 auto;

    margin-bottom: ($font-size-base * 2);
    &:last-child {
        margin-bottom: 0;
    }

    div {
        position: relative;
        width: 100%;
        height: 0;
        overflow: hidden;
        padding-bottom: 56.25%;

        box-shadow: $shadow 6px 6px 16px;
    }

    iframe, object, embed {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        width: 100%;
        height: 100%;
    }
}

.badge img {
    width: 80%;
    height: auto;
}

// Process cards
.process {
    padding-top: 2em;
    padding-bottom: 2em;

    .header {
        display: flex;
        flex-direction: row;
        align-items: center;

        .icon {
            width: 4em;
            height: 4em;
            margin-right: 1em;

            img {
                width: 100%;
                height: auto;
            }
        }

        h4 {
            color: $primary;
            margin: 0;
            padding: 0;
            white-space: nowrap;
        }
    }

    .description {
        padding-left: 5em;
    }
}

// Cards
$card-border-radius: 0;

.cards-sequence {
    margin-top: ($font-size-base * 2);
    margin-bottom: -$font-size-base;

    > div {
        margin-bottom: $font-size-base;
    }

    .card, .not-card {
        border: solid 1px $primary;
        margin-bottom: 1em;

        opacity: 1;
        transform: translateY(0px);
        transition: transform 1.5s ease-out, opacity 0.6s linear;

        .card-title {
            color: $primary;
        }
    }
    &.scroll-in {
        .card, .not-card {
            opacity: 0;
            transform: translateY(-50px);
        }
    }
}
.card {
    .card-counter {
        position: absolute;
        width: 50px;
        height: 50px;
        top: -25px;
        left: -25px;
        border-radius: 50% 50%;
        border: solid 3px white;
        background: $primary;
        text-align: center;
        color: white;
        box-shadow: $gray-300 1px 1px 3px;
        font-size: 1.7rem;
        font-weight: 600;
    }
    .card-img-top {
        width: 100%;
        height: auto;
        object-fit: cover;
        background-image: url(../images/stripe_gray.png);
        background-repeat: repeat;
    }
}

// Stats cards
.stats {
    padding-top: 2em;
    padding-bottom: 2em;
    text-align: center;

    color: $primary;

    transform: rotateZ(2deg);

    > div {
        border-right: solid 1px $primary;
        &:last-of-type {
            border-right: none;
        }
        @include media-breakpoint-down(md) {
            &:nth-child(2n) {
                border-right: none;
            }

            margin-bottom: 2em;
        }
    }

    .stat-counter {
        font-weight: 600;
        font-size: $font-size-h2;
    }
    .stat-description {
        font-size: ($font-size-base * 0.9);
    }
}

// Note
.note {
    margin-top: 3em;
    transform: rotateZ(1deg);
    box-shadow: $shadow 6px 6px 16px;
    border: solid 1px $primary;

    h2 {
        background: $primary;
        color: $white;
        padding: .15em 0;
        text-align: center;

        font-size: $h2-font-size;
        @include media-breakpoint-up(lg) {
            font-size: ($h2-font-size * 1.25);
        }
    }

    .content {
        padding: 15px;
    }

    ul {
        list-style: none;
        margin: 0 0 $font-size-base 0;
        padding: 0;

        li {
            margin: 0 0 ($font-size-base / 2) 0;
            padding: 0;
        }
        li:last-child {
            margin-bottom: 0;
        }
    }

    p:last-child {
        margin-bottom: 0;
    }

    .publish-date {
        display: block;
        font-size: $small-font-size;
        color: $gray-600;
    }
}

// News and articles
article {
    padding-top: $font-size-base;
    padding-bottom: $font-size-base;

    .metadata {
        position: relative;
        min-height: 5em;

        transform: rotateZ(3deg);

        margin-bottom: ($font-size-base * 1.5);
        @include media-breakpoint-up(md) {
            min-height: 8em;
            margin-bottom: 0;
        }

        .thumbnail {
            position: relative;

            // Force square aspect ratio
            width: 40%;
            height: 0;
            padding-bottom: 40%;
            margin-left: auto;
            margin-right: auto;

            @include media-breakpoint-up(md) {
                width: 100%;
                padding-bottom: 100%;
                margin-left: 0;
                margin-right: 0;
            }

            .squarer {
                position: absolute;
                top: 0; left: 0; bottom: 0; right: 0;
            }

            img {
                width: 100%;
                height: 100%;

                border-radius: 50%;
                box-shadow: $shadow 4px 4px 8px;
            }
        }

        .date {
            position: absolute;
            top: 0; left: 0; bottom: 0; right: 0;

            text-align: center;
            color: $black;

            display: flex;
            justify-content: center;
            flex-direction: column;
            line-height: 1;

            border-bottom: dashed 3px $gray-500;
            @include media-breakpoint-down(sm) {
                border-bottom: none;
            }

            .day {
                font-size: $font-size-h1;
                font-weight: $font-weight-bold;
            }
            .month-year {
                font-size: ($font-size-base * 1.4);
            }

            &.shade {
                @include media-breakpoint-down(sm) {
                    width: 40%;
                    left: 30%;
                }

                border-radius: 50%;
                background: transparentize($black, 0.8);
                color: $white;
                text-shadow: $shadow 1px 1px 3px;
                border-bottom: none;
            }
        }
    }

    .small-metadata {
        font-size: ($font-size-base * 0.9);
        color: $gray-700;
        margin-bottom: $font-size-base;

        a {
            color: $gray-700;
        }
    }

    h2 {
        a {
            color: $body-color;
            text-decoration: none;
        }
        a:hover {
            color: $body-color;
            text-decoration: none;
        }
    }
}

.divider {
    height: ($font-size-base * 1.5);
    margin: ($font-size-base * 3) 0;
    background: url(../images/stripe_gray.png) repeat;

    &:last-of-type {
        display: none;
    }
}

nav.intra-section {
    font-size: ($font-size-base * 0.9);
    margin-top: $font-size-base;
    margin-bottom: $font-size-base;
}

.bibliography {
    ul {
        list-style-type: square;

        li {
            margin-bottom: ($font-size-base * 0.25);
            &:last-child {
                margin-bottom: 0;
            }
        }

        .author {
            &:after {
                content: ",";
            }
        }
        .title {
            &:before {
                content: "“";
            }
            &:after {
                content: "”.";
            }
        }
        .publication {
            font-style: italic;

            &:after {
                font-style: normal;
                content: ", ";
            }
        }
        .year {
            &:after {
                content: ".";
            }
        }
        .bibtex-link {
            font-size: $small-font-size;

            &:before {
                content: "(";
            }
            &:after {
                content: ")";
            }
        }
    }

    .bibtex {
        display: none;
        background-color: $code-background;
        color: $code-color;
        border: dashed 1px $gray-500;
        padding: $font-size-base;

        h5 {
            text-align: center;
        }

        .output {
            font-family: $font-family-monospace;
            white-space: pre;
            overflow-x: scroll;
        }

        .copy-confirmation {
            margin-top: $font-size-base;
            padding-top: $font-size-base;
            font-size: $small-font-size;
            color: $gray-600;
            border-top: dashed 1px $gray-500;

            .icon {
                opacity: 0.5;
            }
        }
    }
}

.team-roster {
    list-style: none;

    @include media-breakpoint-up(md) {
        columns: 2;
    }

    li {
        margin: 0 0 1rem 0;
        line-height: 1.5;

        -webkit-column-break-inside: avoid;
        -moz-column-break-inside: avoid;
        -o-column-break-inside: avoid;
        -ms-column-break-inside: avoid;
        column-break-inside: avoid;
    }

    .name {
        font-size: $lead-font-size;
        font-weight: $lead-font-weight;
    }
    .role {
        color: $gray-700;
    }
    .twitter, .web {
        font-size: $font-size-sm;
        color: $gray-500;
        margin-right: $font-size-base;

        .icon {
            margin-right: 2px;
            opacity: 0.6;
        }
        a {
            color: $gray-500;
        }
        a:hover {
            color: $gray-600;
        }
    }
}

#mapdiv {
    width: 100%;
    height: 65vh;
    min-height: 350px;
    margin: ($font-size-base * 2) 0;
    border: none;
    box-shadow: $shadow 6px 6px 16px;

    &.small {
        height: 280px;
        margin: 0 0 $font-size-base 0;
    }
}

ul.pagination {
    justify-content: center;

    li {
        background: $gray-200;
        border: solid 1px $white;
        border-radius: 50%;
        color: $gray-800;
        box-shadow: $shadow 2px 2px 6px;

        padding: 0;
        margin: 0 0.2em;
        width: 3em;
        height: 3em;

        text-align: center;
        line-height: 2.9em;

        a {
            display: block;
            width: 100%;
            height: 100%;
            color: $gray-800;
            text-decoration: none;
        }
        a:hover {
            color: $primary;
            text-decoration: none;
        }

        &:hover {
            background: $gray-100;
            border-color: $primary;
        }

        &.active {
            background: $gray-100;
            border: solid 1px $primary;
            font-weight: $font-weight-bold;
            color: $primary;

            a {
                color: $primary;
            }
        }

        &.disabled {
            border: solid 1px $gray-300;
            background: $gray-200;
            color: $gray-500;

            &:hover {
                background: $gray-200;
            }

            a {
                color: $gray-500;
            }
            a:hover {
                color: $gray-500;
            }
        }
    }
}

// Footer
$footer-background: hsl(222, 20%, 20%);
$footer-text-color: lighten($footer-background, 30%);
$footer-gutter-color: lighten($footer-background, 15%);

footer {
    background: $footer-background;
    padding-top: ($font-size-base * 1.5);
    padding-bottom: ($font-size-base * 1.5);
    font-size: $small-font-size;
    color: $footer-text-color;

    a {
        text-decoration: underline;
        color: $footer-text-color;
    }
    a:hover {
        color: $gray-300;
    }

    h5, h6 {
        color: $primary;
    }

    ul {
        list-style: none;
        padding: 0;
        margin: 0;
        li {
            padding: 0;
            margin: 0;
        }
    }

    p {
        margin: 0 0 0.5em 0;
    }
    p:last-child {
        margin: 0;
    }

    .social-links {
        font-size: ($font-size-base * 1.5);

        a {
            margin-right: 4px;
        }
    }

    @include media-breakpoint-up(md) {
        // 3 columns variant
        .row > div {
            border-right: solid 1px $footer-gutter-color;
        }
        .row > div:last-child {
            border-right: none;
        }
    }
    @include media-breakpoint-only(sm) {
        // 2 columns variant
        .row > div:first-child {
            border-right: solid 1px $footer-gutter-color;
        }
        .row > div:last-child {
            margin-top: $font-size-base;
            padding-top: $font-size-base;
            border-top: solid 1px $footer-gutter-color;
        }
    }
    @include media-breakpoint-down(xs) {
        // Stacked variant
        .row > div {
            margin-bottom: $font-size-base;
            padding-bottom: $font-size-base;
            border-bottom: solid 1px $footer-gutter-color;
        }
        .row > div:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }
    }
}
